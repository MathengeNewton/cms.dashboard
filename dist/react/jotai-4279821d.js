import{r as R,a as q}from"./react-e483b31d.js";let $=0;function g(e,E){const c=`atom${++$}`,d={toString:()=>c};return typeof e=="function"?d.read=e:(d.init=e,d.read=function(f){return f(this)},d.write=function(f,u,D){return u(this,typeof D=="function"?D(f(this)):D)}),E&&(d.write=E),d}const B=e=>"init"in e,b=e=>!!e.write,P=new WeakMap,Y=(e,E)=>{P.set(e,E),e.catch(()=>{}).finally(()=>P.delete(e))},H=(e,E)=>{const c=P.get(e);c&&(P.delete(e),c(E))},G=(e,E)=>{e.status="fulfilled",e.value=E},j=(e,E)=>{e.status="rejected",e.reason=E},Q=e=>typeof(e==null?void 0:e.then)=="function",h=(e,E)=>!!e&&"v"in e&&"v"in E&&Object.is(e.v,E.v),K=(e,E)=>!!e&&"e"in e&&"e"in E&&Object.is(e.e,E.e),p=e=>!!e&&"v"in e&&e.v instanceof Promise,ee=(e,E)=>"v"in e&&"v"in E&&e.v.orig&&e.v.orig===E.v.orig,M=e=>{if("e"in e)throw e.e;return e.v},te=()=>{const e=new WeakMap,E=new WeakMap,c=new Map;let d,f;const u=t=>e.get(t),D=(t,I)=>{const T=e.get(t);if(e.set(t,I),c.has(t)||c.set(t,T),p(T)){const _="v"in I?I.v instanceof Promise?I.v:Promise.resolve(I.v):Promise.reject(I.e);T.v!==_&&H(T.v,_)}},S=(t,I,T)=>{const _=new Map;let o=!1;T.forEach((i,n)=>{!i&&n===t&&(i=I),i&&(_.set(n,i),I.d.get(n)!==i&&(o=!0))}),(o||I.d.size!==_.size)&&(I.d=_)},a=(t,I,T)=>{const _=u(t),o={d:(_==null?void 0:_.d)||new Map,v:I};if(T&&S(t,o,T),h(_,o)&&_.d===o.d)return _;if(p(_)&&p(o)&&ee(_,o)){if(_.d===o.d)return _;o.v=_.v}return D(t,o),o},V=(t,I,T,_)=>{if(Q(I)){let o;const i=()=>{const s=u(t);if(!p(s)||s.v!==n)return;const L=a(t,n,T);E.has(t)&&s.d!==L.d&&y(t,L,s.d)},n=new Promise((s,L)=>{let r=!1;I.then(O=>{r||(r=!0,G(n,O),s(O),i())},O=>{r||(r=!0,j(n,O),L(O),i())}),o=O=>{r||(r=!0,O.then(l=>G(n,l),l=>j(n,l)),s(O))}});return n.orig=I,n.status="pending",Y(n,s=>{s&&o(s),_==null||_()}),a(t,n,T)}return a(t,I,T)},A=(t,I,T)=>{const _=u(t),o={d:(_==null?void 0:_.d)||new Map,e:I};return T&&S(t,o,T),K(_,o)&&_.d===o.d?_:(D(t,o),o)},m=(t,I)=>{const T=u(t);if(!I&&T&&(E.has(t)||Array.from(T.d).every(([r,O])=>{if(r===t)return!0;const l=m(r);return l===O||h(l,O)})))return T;const _=new Map;let o=!0;const i=r=>{if(r===t){const l=u(r);if(l)return _.set(r,l),M(l);if(B(r))return _.set(r,void 0),r.init;throw new Error("no atom init")}const O=m(r);return _.set(r,O),M(O)};let n,s;const L={get signal(){return n||(n=new AbortController),n.signal},get setSelf(){return!s&&b(t)&&(s=(...r)=>{if(!o)return v(t,...r)}),s}};try{const r=t.read(i,L);return V(t,r,_,()=>n==null?void 0:n.abort())}catch(r){return A(t,r,_)}finally{o=!1}},k=t=>M(m(t)),x=t=>{let I=E.get(t);return I||(I=C(t)),I},N=(t,I)=>!I.l.size&&(!I.t.size||I.t.size===1&&I.t.has(t)),Z=t=>{const I=E.get(t);I&&N(t,I)&&w(t)},J=t=>{const I=new Map,T=new WeakMap,_=n=>{var s;const L=new Set((s=E.get(n))==null?void 0:s.t);return c.forEach((r,O)=>{var l;(l=u(O))!=null&&l.d.has(n)&&L.add(O)}),L},o=n=>{_(n).forEach(s=>{s!==n&&(I.set(s,(I.get(s)||new Set).add(n)),T.set(s,(T.get(s)||0)+1),o(s))})};o(t);const i=n=>{_(n).forEach(s=>{var L;if(s!==n){let r=T.get(s);if(r&&T.set(s,--r),!r){let O=!!((L=I.get(s))!=null&&L.size);if(O){const l=u(s),z=m(s,!0);O=!h(l,z)}O||I.forEach(l=>l.delete(s))}i(s)}})};i(t)},W=(t,...I)=>{let T=!0;const _=n=>M(m(n)),o=(n,...s)=>{let L;if(n===t){if(!B(n))throw new Error("atom not writable");const r=u(n),O=V(n,s[0]);h(r,O)||J(n)}else L=W(n,...s);if(!T){const r=F()}return L},i=t.write(_,o,...I);return T=!1,i},v=(t,...I)=>{const T=W(t,...I),_=F();return T},C=(t,I,T)=>{var _;const o=T||[];(_=u(t))==null||_.d.forEach((n,s)=>{const L=E.get(s);L?L.t.add(t):s!==t&&C(s,t,o)}),m(t);const i={t:new Set(I&&[I]),l:new Set};if(E.set(t,i),b(t)&&t.onMount){const{onMount:n}=t;o.push(()=>{const s=n((...L)=>v(t,...L));s&&(i.u=s)})}return T||o.forEach(n=>n()),i},w=t=>{var I;const T=(I=E.get(t))==null?void 0:I.u;T&&T(),E.delete(t);const _=u(t);_&&(p(_)&&H(_.v),_.d.forEach((o,i)=>{if(i!==t){const n=E.get(i);n&&(n.t.delete(t),N(i,n)&&w(i))}}))},y=(t,I,T)=>{const _=new Set(I.d.keys());T==null||T.forEach((o,i)=>{if(_.has(i)){_.delete(i);return}const n=E.get(i);n&&(n.t.delete(t),N(i,n)&&w(i))}),_.forEach(o=>{const i=E.get(o);i?i.t.add(t):E.has(t)&&C(o,t)})},F=()=>{let t;for(;c.size;){const I=Array.from(c);c.clear(),I.forEach(([T,_])=>{const o=u(T);if(o){const i=E.get(T);i&&o.d!==(_==null?void 0:_.d)&&y(T,o,_==null?void 0:_.d),i&&!(!p(_)&&(h(_,o)||K(_,o)))&&i.l.forEach(n=>n())}})}};return{get:k,set:v,sub:(t,I)=>{const T=x(t),_=F(),o=T.l;return o.add(I),()=>{o.delete(I),Z(t)}}}};let U;const _e=()=>(U||(U=te()),U),Ee=R.createContext(void 0),X=e=>{const E=R.useContext(Ee);return(e==null?void 0:e.store)||E||_e()},Ie=e=>typeof(e==null?void 0:e.then)=="function",ne=q.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(E=>{e.status="fulfilled",e.value=E},E=>{e.status="rejected",e.reason=E}),e)});function Te(e,E){const c=X(E),[[d,f,u],D]=R.useReducer(V=>{const A=c.get(e);return Object.is(V[0],A)&&V[1]===c&&V[2]===e?V:[A,c,e]},void 0,()=>[c.get(e),c,e]);let S=d;(f!==c||u!==e)&&(D(),S=c.get(e));const a=E==null?void 0:E.delay;return R.useEffect(()=>{const V=c.sub(e,()=>{if(typeof a=="number"){setTimeout(D,a);return}D()});return D(),V},[c,e,a]),R.useDebugValue(S),Ie(S)?ne(S):S}function oe(e,E){const c=X(E);return R.useCallback((...f)=>c.set(e,...f),[c,e])}function Se(e,E){return[Te(e,E),oe(e,E)]}const se=Symbol(),ie=e=>typeof(e==null?void 0:e.then)=="function";function ce(e){let E,c;const d={getItem:(f,u)=>{var D,S;const a=A=>{if(A=A||"",E!==A){try{c=JSON.parse(A)}catch{return u}E=A}return c},V=(S=(D=e())==null?void 0:D.getItem(f))!=null?S:null;return ie(V)?V.then(a):a(V)},setItem:(f,u)=>{var D;return(D=e())==null?void 0:D.setItem(f,JSON.stringify(u))},removeItem:f=>{var u;return(u=e())==null?void 0:u.removeItem(f)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(d.subscribe=(f,u,D)=>{if(!(e()instanceof window.Storage))return()=>{};const S=a=>{if(a.storageArea===e()&&a.key===f){let V;try{V=JSON.parse(a.newValue||"")}catch{V=D}u(V)}};return window.addEventListener("storage",S),()=>{window.removeEventListener("storage",S)}}),d}const re=ce(()=>typeof window<"u"?window.localStorage:void 0);function ae(e,E,c=re,d){const f=d==null?void 0:d.unstable_getOnInit,u=g(f?c.getItem(e,E):E);return u.onMount=S=>{f||S(c.getItem(e,E));let a;return c.subscribe&&(a=c.subscribe(e,S,E)),a},g(S=>S(u),(S,a,V)=>{const A=typeof V=="function"?V(S(u)):V;return A===se?(a(u,E),c.removeItem(e)):A instanceof Promise?A.then(m=>(a(u,m),c.setItem(e,m))):(a(u,A),c.setItem(e,A))})}export{ae as a,g as b,oe as c,Te as d,ce as e,Se as u};
