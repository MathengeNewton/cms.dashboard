import{av as V,Q as g,r as O,e as U,ao as j,ax as M,v as Q,dl as q,A as B,E as X,l as z,d as G,d0 as J,k as K,X as W,j as u,x as Y,a as o,R as Z,C as ee,dm as te,aA as re,S as oe,F as se,$ as ie}from"./index-e5ac1c37.js";import{y as ae}from"./lodash-bd2b80f6.js";import{u as ne,I as me,a as pe}from"./useProductColumns-2a17b8dd.js";import{r as d}from"./react-e483b31d.js";import{u as ce,a as de,V as le,D as ue,F as he,b as fe,c as _e,d as ve}from"./useHandleProductChange-7fc5d3df.js";import{c as Ce}from"./jotai-4279821d.js";import"./classnames-eea0979a.js";import{u as ge}from"./react-i18next-91d47f13.js";import{e as ye}from"./react-router-82cc6afb.js";import{v as Te}from"./uuid-4a60fe23.js";import"./react-redux-7b717b6c.js";import"./react-dom-ce3e84ee.js";import"./@babel-e5cbf021.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-2fceee1f.js";import"./react-is-e8e5dbb3.js";import"./use-sync-external-store-7794fa59.js";import"./dayjs-75976aa4.js";import"./i18next-076b76a4.js";import"./axios-60492c0c.js";import"./react-hot-toast-d3a0fddd.js";import"./goober-70b4b9ca.js";import"./react-query-557fee5a.js";import"./@azure-485fd2d4.js";import"./@reduxjs-3eb15742.js";import"./immer-85efa438.js";import"./redux-fc7ec223.js";import"./reselect-26feef0e.js";import"./redux-thunk-ef899f4c.js";import"./react-router-dom-67fe6288.js";import"./@remix-run-dd360fb4.js";import"./styled-components-2e13d465.js";import"./tslib-b7af3ea6.js";import"./@emotion-4a2a218f.js";import"./stylis-60528643.js";import"./react-datepicker-27eb8381.js";import"./react-debounce-input-20b6d49d.js";import"./lodash.debounce-ddb7250b.js";import"./@headlessui-220c51a1.js";import"./react-icons-071f44cd.js";import"./react-feather-90dbe0b6.js";import"./prop-types-20aec754.js";import"./@tippyjs-11b6b10a.js";import"./tippy.js-87d3e7d2.js";import"./@popperjs-0aa08b12.js";import"./formik-4b8c99cc.js";import"./deepmerge-15f827de.js";import"./lodash-es-87d1a1d5.js";import"./react-fast-compare-76c36d98.js";import"./tiny-warning-c932d744.js";import"./react-use-57961871.js";import"./react-phone-number-input-4fffe465.js";import"./react-verification-input-7fc81ee7.js";import"./collect.js-ebd014c9.js";import"./react-colorful-fdedf134.js";import"./@react-oauth-6ebaa241.js";import"./react-qr-code-d89187e6.js";import"./qr.js-8bf59ccc.js";import"./react-select-0a6a834e.js";import"./@floating-ui-f24065be.js";import"./use-isomorphic-layout-effect-90624eb0.js";import"./memoize-one-297ddbcb.js";import"./@hello-pangea-bfa72c9a.js";import"./use-memo-one-4ec633fc.js";import"./css-box-model-096cf826.js";import"./tiny-invariant-bee4f299.js";import"./raf-schd-5404ed65.js";import"./array-move-3ca81c74.js";import"./antd-c1c66b30.js";import"./rc-util-6b529ca7.js";import"./@ant-design-6511c079.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@ctrl-fb5a5473.js";import"./rc-resize-observer-f83f8b7d.js";import"./rc-motion-e4fc5c25.js";import"./rc-picker-0dcad4af.js";import"./@rc-component-79b9f5ef.js";import"./rc-pagination-2b5394e8.js";import"./rc-field-form-4872bfbf.js";import"./async-validator-dee29e8b.js";import"./@tinymce-7238a8f2.js";import"./pretty-bytes-5eb460d8.js";import"./react-dropzone-eadb3dbd.js";import"./file-selector-6cb2a621.js";import"./attr-accept-6df8d728.js";import"./react-string-replace-e94ae631.js";import"./currency.js-57f74176.js";import"./react-json-tree-c223e40a.js";import"./react-base16-styling-898a7ddc.js";import"./base16-823cae66.js";import"./color-65b618c9.js";import"./color-string-f5cd3c3e.js";import"./color-name-b7949e8c.js";import"./simple-swizzle-58fb3c22.js";import"./color-convert-946e453a.js";import"./lodash.curry-52fa8793.js";import"./react-turnstile-a0253d8c.js";import"./mitt-f7ef348c.js";import"./@sentry-71948bea.js";import"./@sentry-internal-c0f5a295.js";import"./InvoiceViewer-d9cf5b5b.js";import"./DesignSelector-512fb715.js";import"./designs-ceef87ad.js";import"./ProjectSelector-c72052c6.js";/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function Ie(f){const{setErrors:i,isDefaultFooter:n,isDefaultTerms:m}=f,_=V(),v=Ce(M);return p=>{i(void 0),g.processing();let c="/api/v1/purchase_orders/:id?";m?(c+="save_default_terms=true",n&&(c+="&save_default_footer=true")):n&&(c+="save_default_footer=true"),O("PUT",U(c,{id:p.id}),p).then(async()=>{(m||n)&&await _(),g.success("updated_purchase_order")}).catch(e=>{var s;((s=e.response)==null?void 0:s.status)===422&&(i(e.response.data),g.dismiss())}).finally(()=>{v(void 0),j(["purchase_orders"])})}}function gr(){const{documentTitle:f}=Q("edit_purchase_order"),{t:i}=ge(),{id:n}=ye(),{data:m}=q({id:n}),_=B(),v=X(),p=z(),c=[{name:i("purchase_orders"),href:"/purchase_orders"},{name:i("edit_purchase_order"),href:G("/purchase_orders/:id/edit",{id:n})}],[e,s]=d.useState();d.useEffect(()=>{if(m){const t=ae.cloneDeep(m);t.line_items.forEach(r=>r._id=Te()),t.invitations.forEach(r=>r.client_contact_id=r.client_contact_id||""),s(t)}},[m]);const[S,y]=d.useState(),[l,D]=d.useState(),[T,b]=d.useState(!1),[I,P]=d.useState(!1),x=ne(),a=(t,r)=>{s(h=>h&&{...h,[t]:r})},A=fe(a),E=_e(s),k=ve(s),w=ce(s,y),L=de(s,y),R=Ie({setErrors:D,isDefaultTerms:T,isDefaultFooter:I}),F=J(),C=K(),{changeTemplateVisible:$,setChangeTemplateVisible:H,changeTemplateResources:N}=W();return u(Y,{title:f,breadcrumbs:c,...(_("edit_purchase_order")||v(e))&&e&&{navigationTopRight:o(Z,{resource:e,onSaveClick:()=>R(e),actions:F,cypressRef:"purchaseOrderActionDropdown"})},children:[u("div",{className:"grid grid-cols-12 gap-4",children:[u(ee,{className:"col-span-12 xl:col-span-4 h-max",withContainer:!0,children:[e&&u("div",{className:"flex space-x-20",children:[o("span",{className:"text-sm",style:{backgroundColor:C.$2,color:C.$3,colorScheme:C.$0},children:i("status")}),o(te,{entity:e})]}),o(le,{readonly:!0,resource:e,onChange:t=>a("vendor_id",t),onClearButtonClick:()=>a("vendor_id",""),onContactCheckboxChange:(t,r)=>e&&A(e,t,r),errorMessage:l==null?void 0:l.errors.vendor_id})]}),e&&o(ue,{purchaseOrder:e,handleChange:a,errors:l}),o("div",{className:"col-span-12",children:e?o(re,{type:"product",resource:e,items:e.line_items,columns:x,relationType:"vendor_id",onLineItemChange:(t,r)=>w(e,t,r),onSort:t=>a("line_items",t),onLineItemPropertyChange:(t,r,h)=>L(e,t,r,h),onCreateItemClick:()=>E(e),onDeleteRowClick:t=>k(e,t)}):o(oe,{})}),e&&u(se,{children:[o(he,{purchaseOrder:e,handleChange:a,errors:l,isDefaultFooter:I,isDefaultTerms:T,setIsDefaultFooter:P,setIsDefaultTerms:b}),o(me,{relationType:"vendor_id",resource:e,invoiceSum:S,onChange:(t,r)=>a(t,r)})]})]}),(p==null?void 0:p.show_pdf_preview)&&o("div",{className:"my-4",children:e&&o(pe,{for:"invoice",resource:e,entity:"purchase_order",relationType:"vendor_id",endpoint:"/api/v1/live_preview/purchase_order?entity=:entity",withRemoveLogoCTA:!0})}),o(ie,{entity:"purchase_order",entities:N,visible:$,setVisible:H,labelFn:t=>`${i("number")}: ${t.number}`,bulkUrl:"/api/v1/purchase_orders/bulk"})]})}export{gr as default};
