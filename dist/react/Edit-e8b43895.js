import{u as P,b as k,k as M,j as s,F as I,a as i,d as V,g as w,v as B,h as D,C as E,H as L,G as y,aH as p,o as H,bv as R,aI as N,as as G}from"./index-e5ac1c37.js";import"./react-redux-7b717b6c.js";import"./classnames-eea0979a.js";import{C as q}from"./ConvertCurrency-bccb592f.js";import{r as z}from"./react-e483b31d.js";import{L as F}from"./react-router-dom-67fe6288.js";import{ai as T}from"./react-icons-071f44cd.js";import{u as j}from"./react-i18next-91d47f13.js";import{P as A}from"./PaymentStatus-4a5a4ead.js";import{I as J}from"./InfoCard-d1c839e9.js";import{g as K}from"./react-router-82cc6afb.js";import"./hoist-non-react-statics-2fceee1f.js";import"./@babel-e5cbf021.js";import"./react-is-e8e5dbb3.js";import"./lodash-bd2b80f6.js";import"./dayjs-75976aa4.js";import"./i18next-076b76a4.js";import"./axios-60492c0c.js";import"./react-hot-toast-d3a0fddd.js";import"./goober-70b4b9ca.js";import"./react-query-557fee5a.js";import"./react-dom-ce3e84ee.js";import"./scheduler-765c72db.js";import"./@azure-485fd2d4.js";import"./@reduxjs-3eb15742.js";import"./immer-85efa438.js";import"./redux-fc7ec223.js";import"./reselect-26feef0e.js";import"./redux-thunk-ef899f4c.js";import"./jotai-4279821d.js";import"./styled-components-2e13d465.js";import"./tslib-b7af3ea6.js";import"./@emotion-4a2a218f.js";import"./stylis-60528643.js";import"./react-datepicker-27eb8381.js";import"./react-debounce-input-20b6d49d.js";import"./lodash.debounce-ddb7250b.js";import"./@headlessui-220c51a1.js";import"./react-feather-90dbe0b6.js";import"./prop-types-20aec754.js";import"./@tippyjs-11b6b10a.js";import"./tippy.js-87d3e7d2.js";import"./@popperjs-0aa08b12.js";import"./formik-4b8c99cc.js";import"./deepmerge-15f827de.js";import"./lodash-es-87d1a1d5.js";import"./react-fast-compare-76c36d98.js";import"./tiny-warning-c932d744.js";import"./react-use-57961871.js";import"./react-phone-number-input-4fffe465.js";import"./react-verification-input-7fc81ee7.js";import"./collect.js-ebd014c9.js";import"./uuid-4a60fe23.js";import"./react-colorful-fdedf134.js";import"./@react-oauth-6ebaa241.js";import"./react-qr-code-d89187e6.js";import"./qr.js-8bf59ccc.js";import"./react-select-0a6a834e.js";import"./@floating-ui-f24065be.js";import"./use-isomorphic-layout-effect-90624eb0.js";import"./memoize-one-297ddbcb.js";import"./@hello-pangea-bfa72c9a.js";import"./use-memo-one-4ec633fc.js";import"./css-box-model-096cf826.js";import"./tiny-invariant-bee4f299.js";import"./raf-schd-5404ed65.js";import"./array-move-3ca81c74.js";import"./antd-c1c66b30.js";import"./rc-util-6b529ca7.js";import"./@ant-design-6511c079.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@ctrl-fb5a5473.js";import"./rc-resize-observer-f83f8b7d.js";import"./rc-motion-e4fc5c25.js";import"./rc-picker-0dcad4af.js";import"./@rc-component-79b9f5ef.js";import"./rc-pagination-2b5394e8.js";import"./rc-field-form-4872bfbf.js";import"./async-validator-dee29e8b.js";import"./@tinymce-7238a8f2.js";import"./pretty-bytes-5eb460d8.js";import"./react-dropzone-eadb3dbd.js";import"./file-selector-6cb2a621.js";import"./attr-accept-6df8d728.js";import"./react-string-replace-e94ae631.js";import"./currency.js-57f74176.js";import"./react-json-tree-c223e40a.js";import"./react-base16-styling-898a7ddc.js";import"./base16-823cae66.js";import"./color-65b618c9.js";import"./color-string-f5cd3c3e.js";import"./color-name-b7949e8c.js";import"./simple-swizzle-58fb3c22.js";import"./color-convert-946e453a.js";import"./lodash.curry-52fa8793.js";import"./react-turnstile-a0253d8c.js";import"./mitt-f7ef348c.js";import"./@sentry-71948bea.js";import"./@sentry-internal-c0f5a295.js";import"./use-sync-external-store-7794fa59.js";import"./@remix-run-dd360fb4.js";import"./payment-status-51e1486d.js";function Q(t,l){var m;const d=(m=t==null?void 0:t.invoices)==null?void 0:m.find(e=>e.id==l.invoice_id);return(d==null?void 0:d.number)||""}function U(t){var c,u,h,n,o,a;const[l]=j(),d=P(),{dateFormat:m}=k(),e=M();return s(I,{children:[t.paymentable.invoice_id&&s("div",{className:"grid grid-cols-1 gap-2 my-2 border border-x-5 py-4",children:[i("div",{className:"flex items-center justify-center",children:s("span",{className:"flex item-center gap-2",style:{color:e.$3,colorScheme:e.$0},children:[`${l("invoice")} `,i(F,{to:V("/invoices/:id/edit",{id:t.paymentable.invoice_id}),children:s("span",{className:"flex items-center gap-2",style:{color:e.$3,colorScheme:e.$0},children:[Q(t.payment,t.paymentable)," ",i(T,{})]})})]})}),s("div",{className:"flex items-center justify-center",children:[i("span",{style:{color:e.$3,colorScheme:e.$0},children:d(((c=t==null?void 0:t.paymentable)==null?void 0:c.amount)||0,(u=t.payment.client)==null?void 0:u.country_id,(h=t.payment)==null?void 0:h.currency_id)}),i("span",{className:"mx-5",style:{color:e.$3,colorScheme:e.$0},children:w(new Date(t.paymentable.created_at*1e3).toString(),m)})]})]}),t.paymentable.credit_id&&s("div",{className:"grid grid-cols-1 gap-2 my-2 border border-x-5 py-4",children:[i("div",{className:"flex items-center justify-center",children:i("span",{style:{color:e.$3,colorScheme:e.$0},children:i(F,{to:V("/credits/:id/edit",{id:t.paymentable.credit_id}),children:`${l("credit")} `})})}),s("div",{className:"flex items-center justify-center",children:[i("span",{style:{color:e.$3,colorScheme:e.$0},children:d(((n=t==null?void 0:t.paymentable)==null?void 0:n.amount)||0,(o=t.payment.client)==null?void 0:o.country_id,(a=t.payment)==null?void 0:a.currency_id)}),i("span",{className:"mx-5",style:{color:e.$3,colorScheme:e.$0},children:w(new Date(t.paymentable.created_at*1e3).toString(),m)})]})]})]})}function W(t){var e,c,u,h,n,o,a,_,f,v,g,$,x,S,C;const[l]=j(),d=P(),m=M();return s("div",{children:[s("div",{className:"grid grid-cols-2 gap-4 my-4",children:[i("div",{className:"flex items-center justify-center",children:i("span",{style:{color:m.$3,colorScheme:m.$0},children:`${l("amount")}: ${d(((e=t==null?void 0:t.payment)==null?void 0:e.amount)||0,(c=t.payment.client)==null?void 0:c.country_id,(u=t.payment)==null?void 0:u.currency_id)}`})}),i("div",{className:"flex items-center justify-center",children:i("span",{style:{color:m.$3,colorScheme:m.$0},children:`${l("applied")}: ${d(((h=t==null?void 0:t.payment)==null?void 0:h.applied)||0,(n=t.payment.client)==null?void 0:n.country_id,(o=t.payment)==null?void 0:o.currency_id)}`})}),i("div",{className:"flex items-center justify-center",children:i(A,{entity:t.payment})}),i("div",{className:"flex items-center justify-center",children:i("span",{style:{color:m.$3,colorScheme:m.$0},children:`${l("refunded")}: ${d(((a=t==null?void 0:t.payment)==null?void 0:a.refunded)||0,(_=t.payment.client)==null?void 0:_.country_id,(f=t.payment)==null?void 0:f.currency_id)}`})}),((v=t==null?void 0:t.payment)==null?void 0:v.applied)<((g=t==null?void 0:t.payment)==null?void 0:g.amount)&&s(I,{children:[i("div",{className:"flex items-center justify-center"}),i("div",{className:"flex items-center justify-center",children:i("span",{style:{color:m.$3,colorScheme:m.$0},children:`${l("unapplied")}: ${d((($=t==null?void 0:t.payment)==null?void 0:$.amount)-((x=t==null?void 0:t.payment)==null?void 0:x.applied)||0,(S=t.payment.client)==null?void 0:S.country_id,(C=t.payment)==null?void 0:C.currency_id)}`})})]})]}),i("div",{children:t.payment.paymentables.map(r=>i(U,{payment:t.payment,paymentable:r},r.id))})]})}function X(t){const[l]=j();return i(I,{children:t.client&&i("div",{className:"col-span-12 lg:col-span-3",children:i(J,{title:l("client"),value:i(F,{to:V("/clients/:id",{id:t.client.id}),children:s("span",{className:"flex items-center gap-2",children:[" ",t.client.display_name," ",i(T,{})," "]})}),className:"h-full"})})})}function Jt(){var _,f,v,g,$,x,S,C;const{documentTitle:t}=B("edit_payment"),[l]=j(),d=K(),{setPayment:m,payment:e,errors:c}=d,[u,h]=z.useState(!!(e!=null&&e.exchange_currency_id)),n=D(),o=M(),a=(r,b)=>{m(O=>O&&{...O,[r]:b})};return s(E,{title:t,children:[(e==null?void 0:e.client)&&i(X,{client:e.client}),e&&i(W,{payment:e}),i(L,{}),i(y,{leftSide:l("payment_number"),children:i(p,{style:{color:o.$3,colorScheme:o.$0},id:"number",value:e==null?void 0:e.number,onValueChange:r=>a("number",r),errorMessage:c==null?void 0:c.errors.number})}),i(y,{leftSide:l("payment_date"),children:i(p,{style:{color:o.$3,colorScheme:o.$0},id:"date",type:"date",value:e==null?void 0:e.date,onValueChange:r=>a("date",r),errorMessage:c==null?void 0:c.errors.date})}),i(y,{leftSide:l("payment_type"),children:i(H,{style:{color:o.$3,colorScheme:o.$0},id:"type_id",value:e==null?void 0:e.type_id,onValueChange:r=>a("type_id",r),errorMessage:c==null?void 0:c.errors.type_id,withBlank:!0,children:Object.entries(R).map((r,b)=>i("option",{value:String(r[0]),children:l(r[1])},b))})}),i(y,{leftSide:l("transaction_reference"),children:i(p,{style:{color:o.$3,colorScheme:o.$0},id:"transaction_reference",onValueChange:r=>a("transaction_reference",r),value:e==null?void 0:e.transaction_reference,errorMessage:c==null?void 0:c.errors.transaction_reference})}),i(y,{leftSide:l("private_notes"),children:i(p,{style:{color:o.$3,colorScheme:o.$0},element:"textarea",id:"private_notes",value:e==null?void 0:e.private_notes,onValueChange:r=>a("private_notes",r),errorMessage:c==null?void 0:c.errors.private_notes})}),((_=n==null?void 0:n.custom_fields)==null?void 0:_.payment1)&&i(N,{field:"custom_value1",defaultValue:e==null?void 0:e.custom_value1,value:(f=n==null?void 0:n.custom_fields)==null?void 0:f.payment1,onValueChange:r=>a("custom_value1",r.toString())}),((v=n==null?void 0:n.custom_fields)==null?void 0:v.payment2)&&i(N,{field:"custom_value2",defaultValue:e==null?void 0:e.custom_value2,value:(g=n==null?void 0:n.custom_fields)==null?void 0:g.payment2,onValueChange:r=>a("custom_value2",r.toString())}),(($=n==null?void 0:n.custom_fields)==null?void 0:$.payment3)&&i(N,{field:"custom_value3",defaultValue:e==null?void 0:e.custom_value3,value:(x=n==null?void 0:n.custom_fields)==null?void 0:x.payment3,onValueChange:r=>a("custom_value3",r.toString())}),((S=n==null?void 0:n.custom_fields)==null?void 0:S.payment4)&&i(N,{field:"custom_value4",defaultValue:e==null?void 0:e.custom_value4,value:(C=n==null?void 0:n.custom_fields)==null?void 0:C.payment4,onValueChange:r=>a("custom_value4",r.toString())}),i(y,{leftSide:l("convert_currency"),children:i(G,{style:{color:o.$3,colorScheme:o.$0},checked:!!(e!=null&&e.exchange_currency_id),onChange:r=>{h(r),r||(a("exchange_currency_id",""),a("exchange_rate",1))}})}),e&&(!!(e!=null&&e.exchange_currency_id)||u)&&i(q,{exchangeRate:e.exchange_rate.toString()||"1",exchangeCurrencyId:e.exchange_currency_id||"1",currencyId:e.currency_id||"1",amount:e==null?void 0:e.amount,onChange:(r,b)=>{a("exchange_rate",r),a("exchange_currency_id",b)},onExchangeRateChange:r=>a("exchange_rate",r)})]})}export{Jt as default};
