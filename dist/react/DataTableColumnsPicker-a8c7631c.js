import{an as w,l as z,j as r,F as E,a3 as U,a as s,o as $,O as m,I as B,p as x,Q as y,r as H,e as T,ao as V,ap as q}from"./index-ecbcc3c7.js";import{y as h}from"./lodash-bd2b80f6.js";import{r as c}from"./react-e483b31d.js";import{u as O,a as Q}from"./react-redux-7b717b6c.js";import"./classnames-eea0979a.js";import"./react-debounce-input-20b6d49d.js";import{o as _,v as D}from"./react-icons-071f44cd.js";import{D as A,C as G,P as J}from"./@hello-pangea-bfa72c9a.js";import{a as K}from"./array-move-3ca81c74.js";import{u as L}from"./react-i18next-91d47f13.js";function re(i){var b;const v=O(e=>e.user.user),k=Q(),{t:l}=L(),{table:g,defaultColumns:C}=i;w();const u=z(),[P,p]=c.useState(i.columns),[o,d]=c.useState(((b=u==null?void 0:u.react_table_columns)==null?void 0:b[g])||C),[I,f]=c.useState(!1);c.useEffect(()=>{p(e=>e.filter(n=>!o.includes(n)))},[o]);const N=c.useCallback(e=>{e.length>1&&d(n=>[...n,e])},[]),S=()=>{const e=h.cloneDeep(v);h.set(e,`company_user.react_settings.react_table_columns.${g}`,o),y.processing(),H("PUT",T("/api/v1/company_users/:id",{id:e.id}),e).then(n=>{h.set(e,"company_user",n.data.data),f(!1),V(["company_users"]),k(q(e)),y.success("saved_settings")})},j=e=>{const n=o.filter(t=>!t.includes(e));d(n);const a=i.columns.filter(t=>!n.find(F=>F===t));p(a)},M=e=>{var a;const n=K(o,e.source.index,(a=e.destination)==null?void 0:a.index);d(n)},R=c.useCallback(()=>{d(C),p(i.columns)},[]);return r(E,{children:[r(U,{title:l("edit_columns"),visible:I,onClose:f,children:[s($,{label:l("add_column"),onValueChange:N,value:"",withBlank:!0,cypressRef:"columSelector",children:P.map((e,n)=>s("option",{value:e,children:l(e)},n))}),s(A,{onDragEnd:M,children:s(G,{droppableId:"columns",renderClone:(e,n,a)=>{const t=o[a.source.index];return r("div",{ref:e.innerRef,...e.draggableProps,className:"flex items-center justify-between py-2 text-sm",children:[r("div",{className:"flex space-x-2 items-center",children:[s(m,{element:_,size:20}),s("p",{children:l(t)})]}),s("div",{...e.dragHandleProps,children:s(m,{element:D,size:23})})]})},children:e=>r("div",{...e.droppableProps,ref:e.innerRef,children:[o.map((n,a)=>s(J,{draggableId:`item-${a}`,index:a,children:t=>r("div",{ref:t.innerRef,...t.draggableProps,className:"flex items-center justify-between py-2",children:[r("div",{className:"flex space-x-2 items-center",children:[s(m,{className:"cursor-pointer",element:_,size:20,onClick:()=>j(n)}),s("p",{children:l(n)})]}),s("div",{...t.dragHandleProps,children:s(m,{element:D,size:23})})]})},a)),e.placeholder]})})}),s("div",{className:"flex lg:flex-row lg:justify-end",children:r(B,{children:[s(x,{type:"minimal",className:"mx-2",onClick:R,children:l("reset")}),s(x,{onClick:S,children:l("save")})]})})]}),s("button",{className:"hidden lg:block lg:mx-4 text-sm",onClick:()=>f(!0),children:l("columns")})]})}export{re as D};
