import{a as e,F as T,k as w,r as E,bR as _,e as j,j as d,O as N,dg as H,S as z,v as I,bH as U,dh as F,A as L,E as M,d as S,aJ as $,x as A,R as O,bm as G,as as q,H as Q,di as J}from"./index-e5ac1c37.js";import{r as c}from"./react-e483b31d.js";import{P as V,a as K,b as W}from"./react-resizable-panels-7884a1bc.js";import{s as X}from"./styled-components-2e13d465.js";import{a as R}from"./InvoiceViewer-d9cf5b5b.js";import{an as Y,ao as Z,ap as ee,aq as te}from"./react-icons-071f44cd.js";import{u as re}from"./react-query-557fee5a.js";import{u as B}from"./react-i18next-91d47f13.js";import{r as se}from"./react-responsive-086ba234.js";import{e as oe,O as ie}from"./react-router-82cc6afb.js";import"./react-redux-7b717b6c.js";import"./react-dom-ce3e84ee.js";import"./@babel-e5cbf021.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-2fceee1f.js";import"./react-is-e8e5dbb3.js";import"./use-sync-external-store-7794fa59.js";import"./lodash-bd2b80f6.js";import"./dayjs-75976aa4.js";import"./i18next-076b76a4.js";import"./axios-60492c0c.js";import"./react-hot-toast-d3a0fddd.js";import"./goober-70b4b9ca.js";import"./@azure-485fd2d4.js";import"./@reduxjs-3eb15742.js";import"./immer-85efa438.js";import"./redux-fc7ec223.js";import"./reselect-26feef0e.js";import"./redux-thunk-ef899f4c.js";import"./jotai-4279821d.js";import"./classnames-eea0979a.js";import"./react-router-dom-67fe6288.js";import"./@remix-run-dd360fb4.js";import"./react-datepicker-27eb8381.js";import"./react-debounce-input-20b6d49d.js";import"./lodash.debounce-ddb7250b.js";import"./@headlessui-220c51a1.js";import"./react-feather-90dbe0b6.js";import"./prop-types-20aec754.js";import"./@tippyjs-11b6b10a.js";import"./tippy.js-87d3e7d2.js";import"./@popperjs-0aa08b12.js";import"./formik-4b8c99cc.js";import"./deepmerge-15f827de.js";import"./lodash-es-87d1a1d5.js";import"./react-fast-compare-76c36d98.js";import"./tiny-warning-c932d744.js";import"./react-use-57961871.js";import"./react-phone-number-input-4fffe465.js";import"./react-verification-input-7fc81ee7.js";import"./collect.js-ebd014c9.js";import"./uuid-4a60fe23.js";import"./react-colorful-fdedf134.js";import"./@react-oauth-6ebaa241.js";import"./react-qr-code-d89187e6.js";import"./qr.js-8bf59ccc.js";import"./react-select-0a6a834e.js";import"./@emotion-4a2a218f.js";import"./stylis-60528643.js";import"./@floating-ui-f24065be.js";import"./use-isomorphic-layout-effect-90624eb0.js";import"./memoize-one-297ddbcb.js";import"./@hello-pangea-bfa72c9a.js";import"./use-memo-one-4ec633fc.js";import"./css-box-model-096cf826.js";import"./tiny-invariant-bee4f299.js";import"./raf-schd-5404ed65.js";import"./array-move-3ca81c74.js";import"./antd-c1c66b30.js";import"./rc-util-6b529ca7.js";import"./@ant-design-6511c079.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@ctrl-fb5a5473.js";import"./rc-resize-observer-f83f8b7d.js";import"./rc-motion-e4fc5c25.js";import"./rc-picker-0dcad4af.js";import"./@rc-component-79b9f5ef.js";import"./rc-pagination-2b5394e8.js";import"./rc-field-form-4872bfbf.js";import"./async-validator-dee29e8b.js";import"./@tinymce-7238a8f2.js";import"./pretty-bytes-5eb460d8.js";import"./react-dropzone-eadb3dbd.js";import"./file-selector-6cb2a621.js";import"./tslib-b7af3ea6.js";import"./attr-accept-6df8d728.js";import"./react-string-replace-e94ae631.js";import"./currency.js-57f74176.js";import"./react-json-tree-c223e40a.js";import"./react-base16-styling-898a7ddc.js";import"./base16-823cae66.js";import"./color-65b618c9.js";import"./color-string-f5cd3c3e.js";import"./color-name-b7949e8c.js";import"./simple-swizzle-58fb3c22.js";import"./color-convert-946e453a.js";import"./lodash.curry-52fa8793.js";import"./react-turnstile-a0253d8c.js";import"./mitt-f7ef348c.js";import"./@sentry-71948bea.js";import"./@sentry-internal-c0f5a295.js";function C(t){const{children:a,renderBasePanel:n}=t;return n?e(V,{defaultSize:50,minSize:25,children:a}):e(T,{children:a})}function ne(t){const{children:a,renderBasePanelGroup:n}=t;return n?e(K,{direction:"horizontal",className:"gap-4 mt-4",children:a}):e("div",{className:"flex flex-col gap-4",children:a})}const ae=X(W)`
  background-color: ${t=>t.theme.backgroundColor};
  &:hover {
    background-color: ${t=>t.theme.hoverColor};
  }
`;function me(t){const a=w(),{renderBasePanelResizeHandler:n}=t;return n?e(ae,{className:"flex items-center",theme:{hoverColor:"#3366CC",backgroundColor:a.$5},style:{width:"2.5px"}}):e(T,{})}function pe(t){var p;const[a]=B(),n=re(),{documents:o}=t,y=c.useRef(null),[f,l]=c.useState(""),[h,g]=c.useState(!1),[m,u]=c.useState(0),[b,x]=c.useState(!1),s=()=>{var i;const r=(i=o[m])==null?void 0:i.type;return r==="png"||r==="jpg"||r==="gif"||r==="webp"||r==="tiff"},v=()=>{var i;return((i=o[m])==null?void 0:i.type)==="pdf"};return c.useEffect(()=>{var r;return o.length&&(g(!0),x(!1),o[m]?n.fetchQuery(["/api/v1/documents",(r=o[m])==null?void 0:r.hash],()=>{var i;return E("GET",j("/documents/:hash",{hash:(i=o[m])==null?void 0:i.hash}),{headers:_()},{responseType:"arraybuffer"})},{staleTime:1/0}).then(i=>{const P=new Blob([i.data],{type:i.headers["content-type"]});s()?l(URL.createObjectURL(P)):!R&&y.current&&v()?y.current.src=URL.createObjectURL(P):x(!0)}).finally(()=>g(!1)):u(0)),()=>{l(""),g(!1),x(!1)}},[o,m]),R?e("p",{children:"Unable to preview PDF. Â "}):d(T,{children:[o.length?d("div",{className:"flex flex-col",children:[!h&&d("div",{className:"flex self-end pb-1",children:[e(N,{className:"cursor-pointer",element:Y,size:25,onClick:()=>u(0)}),e(N,{className:"cursor-pointer",element:Z,size:25,onClick:()=>m!==0&&u(r=>r-1)}),e(N,{className:"cursor-pointer",element:ee,size:25,onClick:()=>m!==o.length-1&&u(r=>r+1)}),e(N,{className:"cursor-pointer",element:te,size:25,onClick:()=>u(o.length-1)})]}),s()&&!h&&!b&&e("img",{className:"w-full",src:f}),e("iframe",{ref:y,width:"100%",height:h||!v()||b?0:1500}),b&&e("div",{className:"flex h-full justify-center items-center",children:e(H,{type:(p=o[m])==null?void 0:p.type,size:150})})]}):d("div",{className:"flex justify-center",children:[a("no_records_found"),"."]}),h&&e("div",{className:"flex justify-center items-center h-full",children:e(z,{})})]})}function sr(){const[t]=B(),{documentTitle:a}=I("edit_expense"),{id:n}=oe(),o=U(),y=w(),{data:f}=F({id:n}),l=se.useMediaQuery({query:"(min-width: 1024px)"}),h=L(),g=M(),m=[{name:t("expenses"),href:"/expenses"},{name:t("edit_expense"),href:S("/expenses/:id/edit",{id:n})}],u=[{name:t("edit"),href:S("/expenses/:id/edit",{id:n})},{name:t("documents"),href:S("/expenses/:id/documents",{id:n}),formatName:()=>e($,{numberOfDocuments:s==null?void 0:s.documents.length})}],[b,x]=c.useState(),[s,v]=c.useState(),[p,r]=c.useState(!1),[i,P]=c.useState("by_rate"),k=J({setErrors:x});return c.useEffect(()=>{f&&(v(f),P(f.calculate_tax_by_amount?"by_amount":"by_rate"))},[f]),e(A,{title:a,breadcrumbs:m,...(h("edit_expense")||g(s))&&s&&{navigationTopRight:e(O,{resource:s,onSaveClick:()=>k(s),actions:o,disableSaveButton:!s,cypressRef:"expenseActionDropdown"})},children:s?d("div",{className:"space-y-4",children:[e(G,{tabs:u,rightSide:d("div",{className:"flex items-center justify-end space-x-3",children:[e("span",{className:"text-sm",children:t("preview")}),e(q,{checked:p,onValueChange:D=>r(D)})]})}),d(ne,{renderBasePanelGroup:p&&l,children:[e(C,{renderBasePanel:p&&l,children:e(ie,{context:{errors:b,setErrors:x,expense:s,setExpense:v,taxInputType:i,setTaxInputType:P,isPreviewMode:p}})}),e(me,{renderBasePanelResizeHandler:p&&l}),p&&!l&&e(Q,{className:"pt-4",withoutPadding:!0,borderColor:y.$5}),e(C,{renderBasePanel:p&&l,children:p&&e(pe,{documents:s.documents})})]})]}):e(z,{})})}export{sr as default};
