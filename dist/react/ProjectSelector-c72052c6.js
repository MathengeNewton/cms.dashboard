import{aZ as S,h as P,az as x,a as s,a3 as y,j as h,F as p,aH as c,aD as V,aN as B,p as E,S as w,Q as v,r as F,e as C,ao as O,A as I,a_ as N,a$ as A}from"./index-e5ac1c37.js";import"./react-redux-7b717b6c.js";import"./classnames-eea0979a.js";import{r as _}from"./react-e483b31d.js";import{u as k}from"./react-i18next-91d47f13.js";function D(n){const[l]=k(),{data:r}=S(),[t,u]=_.useState(),[e,o]=_.useState(),[m,f]=_.useState(!1),b=P(),j=x(),i=(a,d)=>{o(void 0),u(g=>g&&{...g,[a]:d})};_.useEffect(()=>{r&&u({...r,task_rate:(b==null?void 0:b.settings.default_task_rate)||0})},[r]),_.useEffect(()=>{t!=null&&t.client_id&&t.client_id.length>1&&j.find(t.client_id).then(a=>{a.settings.default_task_rate&&i("task_rate",a.settings.default_task_rate)})},[t==null?void 0:t.client_id]);const M=a=>{a.preventDefault(),m||(v.processing(),o(void 0),f(!0),F("POST",C("/api/v1/projects"),t).then(d=>{v.success("created_project"),O(["projects"]),window.dispatchEvent(new CustomEvent("invalidate.combobox.queries",{detail:{url:C("/api/v1/projects")}})),n.onProjectCreated(d.data.data),u(r),n.setVisible(!1)}).catch(d=>{var g;((g=d.response)==null?void 0:g.status)===422&&(v.dismiss(),o(d.response.data))}).finally(()=>f(!1)))};return s(y,{title:l("new_project"),size:"regular",visible:n.visible,onClose:()=>{u(r),n.setVisible(!1)},children:t?h(p,{children:[h("div",{className:"grid grid-cols-2 gap-x-5 gap-y-3",children:[s(c,{label:l("project_name"),value:t.name,onValueChange:a=>i("name",a),errorMessage:e==null?void 0:e.errors.name}),s(V,{inputLabel:l("client"),value:t.client_id,onChange:a=>i("client_id",a.id),clearButton:!0,onClearButtonClick:()=>i("client_id",""),errorMessage:e==null?void 0:e.errors.client_id}),s(B,{inputLabel:l("user"),value:t.assigned_user_id,onChange:a=>i("assigned_user_id",a.id),onClearButtonClick:()=>i("assigned_user_id",""),errorMessage:e==null?void 0:e.errors.assigned_user_id}),s(c,{label:l("due_date"),type:"date",value:t.due_date,onValueChange:a=>i("due_date",a),errorMessage:e==null?void 0:e.errors.due_date}),s(c,{label:l("budgeted_hours"),value:t.budgeted_hours,onValueChange:a=>i("budgeted_hours",a),errorMessage:e==null?void 0:e.errors.budgeted_hours}),s(c,{label:l("task_rate"),value:t.task_rate,onValueChange:a=>i("task_rate",a),errorMessage:e==null?void 0:e.errors.task_rate}),s(c,{label:l("public_notes"),element:"textarea",value:t.public_notes,onValueChange:a=>i("public_notes",a),errorMessage:e==null?void 0:e.errors.public_notes}),s(c,{label:l("private_notes"),element:"textarea",value:t.private_notes,onValueChange:a=>i("private_notes",a),errorMessage:e==null?void 0:e.errors.private_notes})]}),s(E,{className:"flex self-end",disableWithoutIcon:!0,disabled:!t||m,onClick:M,children:l("save")})]}):s(w,{})})}function R(n){var e;const[l]=k(),r=I(),[t,u]=_.useState(!1);return h(p,{children:[s(D,{visible:t,setVisible:u,onProjectCreated:o=>n.onChange(o)}),s(N,{inputOptions:{label:(e=n.inputLabel)==null?void 0:e.toString(),value:n.value??null},endpoint:C("/api/v1/projects?status=active"),entryOptions:{id:"id",label:"name",value:"id"},onChange:o=>o.resource?n.onChange(o.resource):null,readonly:n.readonly,onDismiss:n.onClearButtonClick,action:{label:l("new_project"),onClick:()=>u(!0),visible:r("create_project")}}),n.errorMessage?s(A,{className:"mt-2",type:"danger",children:n.errorMessage}):null]})}export{R as P};
