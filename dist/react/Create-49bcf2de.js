import{v as j,h as B,az as E,aZ as P,a as o,x as D,bU as F,j as T,C as q,G as l,aH as p,aD as R,aN as w,aI as d,Q as _,r as A,e as I,ao as N,d as Q}from"./index-e5ac1c37.js";import"./react-redux-7b717b6c.js";import{u as U}from"./react-router-dom-67fe6288.js";import"./classnames-eea0979a.js";import{r as f}from"./react-e483b31d.js";import{y}from"./lodash-bd2b80f6.js";import{p as z}from"./atoms-cf2b0802.js";import{u as G}from"./react-i18next-91d47f13.js";import{a as H}from"./react-router-82cc6afb.js";import{u as O}from"./jotai-4279821d.js";import"./hoist-non-react-statics-2fceee1f.js";import"./@babel-e5cbf021.js";import"./react-is-e8e5dbb3.js";import"./dayjs-75976aa4.js";import"./i18next-076b76a4.js";import"./axios-60492c0c.js";import"./react-hot-toast-d3a0fddd.js";import"./goober-70b4b9ca.js";import"./react-query-557fee5a.js";import"./react-dom-ce3e84ee.js";import"./scheduler-765c72db.js";import"./@azure-485fd2d4.js";import"./@reduxjs-3eb15742.js";import"./immer-85efa438.js";import"./redux-fc7ec223.js";import"./reselect-26feef0e.js";import"./redux-thunk-ef899f4c.js";import"./styled-components-2e13d465.js";import"./tslib-b7af3ea6.js";import"./@emotion-4a2a218f.js";import"./stylis-60528643.js";import"./react-datepicker-27eb8381.js";import"./react-debounce-input-20b6d49d.js";import"./lodash.debounce-ddb7250b.js";import"./@headlessui-220c51a1.js";import"./react-icons-071f44cd.js";import"./react-feather-90dbe0b6.js";import"./prop-types-20aec754.js";import"./@tippyjs-11b6b10a.js";import"./tippy.js-87d3e7d2.js";import"./@popperjs-0aa08b12.js";import"./formik-4b8c99cc.js";import"./deepmerge-15f827de.js";import"./lodash-es-87d1a1d5.js";import"./react-fast-compare-76c36d98.js";import"./tiny-warning-c932d744.js";import"./react-use-57961871.js";import"./react-phone-number-input-4fffe465.js";import"./react-verification-input-7fc81ee7.js";import"./collect.js-ebd014c9.js";import"./uuid-4a60fe23.js";import"./react-colorful-fdedf134.js";import"./@react-oauth-6ebaa241.js";import"./react-qr-code-d89187e6.js";import"./qr.js-8bf59ccc.js";import"./react-select-0a6a834e.js";import"./@floating-ui-f24065be.js";import"./use-isomorphic-layout-effect-90624eb0.js";import"./memoize-one-297ddbcb.js";import"./@hello-pangea-bfa72c9a.js";import"./use-memo-one-4ec633fc.js";import"./css-box-model-096cf826.js";import"./tiny-invariant-bee4f299.js";import"./raf-schd-5404ed65.js";import"./array-move-3ca81c74.js";import"./antd-c1c66b30.js";import"./rc-util-6b529ca7.js";import"./@ant-design-6511c079.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@ctrl-fb5a5473.js";import"./rc-resize-observer-f83f8b7d.js";import"./rc-motion-e4fc5c25.js";import"./rc-picker-0dcad4af.js";import"./@rc-component-79b9f5ef.js";import"./rc-pagination-2b5394e8.js";import"./rc-field-form-4872bfbf.js";import"./async-validator-dee29e8b.js";import"./@tinymce-7238a8f2.js";import"./pretty-bytes-5eb460d8.js";import"./react-dropzone-eadb3dbd.js";import"./file-selector-6cb2a621.js";import"./attr-accept-6df8d728.js";import"./react-string-replace-e94ae631.js";import"./currency.js-57f74176.js";import"./react-json-tree-c223e40a.js";import"./react-base16-styling-898a7ddc.js";import"./base16-823cae66.js";import"./color-65b618c9.js";import"./color-string-f5cd3c3e.js";import"./color-name-b7949e8c.js";import"./simple-swizzle-58fb3c22.js";import"./color-convert-946e453a.js";import"./lodash.curry-52fa8793.js";import"./react-turnstile-a0253d8c.js";import"./mitt-f7ef348c.js";import"./@sentry-71948bea.js";import"./@sentry-internal-c0f5a295.js";import"./use-sync-external-store-7794fa59.js";import"./@remix-run-dd360fb4.js";function Nt(){var C,S,b,V;const{documentTitle:g}=j("new_project"),[m]=G(),k=[{name:m("projects"),href:"/projects"},{name:m("new_project"),href:"/projects/create"}],[u]=U(),[e,h]=O(z),[i,v]=f.useState(),r=B(),x=E(),M=H(),a=(t,s)=>{h(n=>n&&{...n,[t]:s})},{data:c}=P({enabled:typeof e>"u"});return f.useEffect(()=>{h(t=>{let s=t;if(u.get("action")!=="clone"&&(s=void 0),typeof c<"u"&&typeof s>"u"&&u.get("action")!=="clone"){const n=y.cloneDeep(c);n.task_rate=(r==null?void 0:r.settings.default_task_rate)||0,u.get("client")&&(n.client_id=u.get("client")),s=n}return s})},[c]),f.useEffect(()=>{e!=null&&e.client_id&&e.client_id.length>1&&x.find(e.client_id).then(t=>{t.settings.default_task_rate&&a("task_rate",t.settings.default_task_rate)})},[e==null?void 0:e.client_id]),o(D,{title:g,breadcrumbs:k,disableSaveButton:!e,onSaveClick:t=>{t.preventDefault(),_.processing(),v(void 0),A("POST",I("/api/v1/projects"),e).then(s=>{_.success("created_project"),N(["projects"]),M(Q("/projects/:id/edit",{id:s.data.data.id}))}).catch(s=>{var n;((n=s.response)==null?void 0:n.status)===422&&(_.dismiss(),v(s.response.data))})},children:o(F,{children:T(q,{title:g,children:[o(l,{leftSide:m("project_name"),required:!0,children:o(p,{value:e==null?void 0:e.name,onValueChange:t=>a("name",t),errorMessage:i==null?void 0:i.errors.name,cypressRef:"name"})}),o(l,{leftSide:m("client"),required:!0,children:o(R,{value:e==null?void 0:e.client_id,onChange:t=>a("client_id",t.id),clearButton:!!(e!=null&&e.client_id),onClearButtonClick:()=>a("client_id",""),errorMessage:i==null?void 0:i.errors.client_id})}),o(l,{leftSide:m("user"),children:o(w,{value:e==null?void 0:e.assigned_user_id,onChange:t=>a("assigned_user_id",t.id),onClearButtonClick:()=>a("assigned_user_id",""),errorMessage:i==null?void 0:i.errors.assigned_user_id})}),o(l,{leftSide:m("due_date"),children:o(p,{type:"date",value:e==null?void 0:e.due_date,onValueChange:t=>a("due_date",t),errorMessage:i==null?void 0:i.errors.due_date})}),o(l,{leftSide:m("budgeted_hours"),children:o(p,{type:"number",value:e==null?void 0:e.budgeted_hours,onValueChange:t=>a("budgeted_hours",parseFloat(t)),errorMessage:i==null?void 0:i.errors.budgeted_hours})}),o(l,{leftSide:m("task_rate"),children:o(p,{type:"number",value:e==null?void 0:e.task_rate,onValueChange:t=>a("task_rate",parseFloat(t)),errorMessage:i==null?void 0:i.errors.task_rate})}),o(l,{leftSide:m("public_notes"),children:o(p,{element:"textarea",value:e==null?void 0:e.public_notes,onValueChange:t=>a("public_notes",t),errorMessage:i==null?void 0:i.errors.public_notes})}),o(l,{leftSide:m("private_notes"),children:o(p,{element:"textarea",value:e==null?void 0:e.private_notes,onValueChange:t=>a("private_notes",t),errorMessage:i==null?void 0:i.errors.private_notes})}),e&&((C=r==null?void 0:r.custom_fields)==null?void 0:C.project1)&&o(d,{field:"project1",defaultValue:e.custom_value1||"",value:r.custom_fields.project1,onValueChange:t=>a("custom_value1",t.toString())}),e&&((S=r==null?void 0:r.custom_fields)==null?void 0:S.project2)&&o(d,{field:"project2",defaultValue:e.custom_value2||"",value:r.custom_fields.project2,onValueChange:t=>a("custom_value2",t.toString())}),e&&((b=r==null?void 0:r.custom_fields)==null?void 0:b.project3)&&o(d,{field:"project3",defaultValue:e.custom_value3||"",value:r.custom_fields.project3,onValueChange:t=>a("custom_value3",t.toString())}),e&&((V=r==null?void 0:r.custom_fields)==null?void 0:V.project4)&&o(d,{field:"project4",defaultValue:e.custom_value4||"",value:r.custom_fields.project4,onValueChange:t=>a("custom_value4",t.toString())})]})})})}export{Nt as default};
