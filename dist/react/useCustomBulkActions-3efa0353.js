import{k as S,j as f,F as B,a as o,a2 as c,O as m,a3 as I,p as x,A as E,ac as j,X as N,Q as h,aq as O}from"./index-ecbcc3c7.js";import{u as T}from"./useDownloadPdfs-dc322b9d.js";import{N as $,P as q,I as k,R as F,ag as Q,V}from"./react-icons-071f44cd.js";import"./classnames-eea0979a.js";import{r as H}from"./react-e483b31d.js";import"./react-debounce-input-20b6d49d.js";import"./react-redux-7b717b6c.js";import{b as C}from"./hooks-759c8745.js";import{u as _}from"./react-i18next-91d47f13.js";import{a as y}from"./CreditStatus-2462f3d7.js";import{c as R}from"./collect.js-ebd014c9.js";import{u as X}from"./payments-ff169d7b.js";import{p as z}from"./atoms-1e1b685d.js";import{a as G}from"./react-router-82cc6afb.js";import{v as J}from"./uuid-4a60fe23.js";import{c as K}from"./jotai-c7720f6e.js";const L=n=>{const[s]=_(),[d,r]=H.useState(!1),{selectedIds:i,setSelected:l}=n,p=C(),u=S();return f(B,{children:[o(c,{onClick:()=>r(!0),icon:o(m,{element:$}),children:s("send_email")}),f(I,{title:s("bulk_email_credits"),visible:d,onClose:()=>r(!1),children:[o("span",{className:"text-lg",style:{backgroundColor:u.$2,color:u.$3,colorScheme:u.$0},children:s("are_you_sure")}),o("div",{className:"flex justify-end space-x-4 mt-5",children:o(x,{behavior:"button",onClick:()=>{p(i,"email"),l([]),r(!1)},children:s("yes")})})]})]})};/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */const U=()=>{const n=G(),s=K(z),{data:d}=X();return r=>{d&&(s({...d.data.data,invoices:[],credits:[],client_id:r[0].client_id}),r.forEach(i=>{s(l=>l&&{...l,credits:[...l.credits,{_id:J(),credit_id:i.id,amount:i.balance>0?i.balance:i.amount}]})}),n("/payments/create?action=apply&type=1"))}},fe=()=>{const[n]=_(),s=C(),d=E(),r=O(),i=U(),l=j({entity:"credit"}),p=T({entity:"credit"}),u=e=>!e.some(({status_id:t,is_deleted:a})=>t!==y.Draft||a),g=e=>e.some(({documents:t})=>t.length),A=e=>e.flatMap(({documents:t})=>t.map(({id:a})=>a)),b=(e,t)=>{const a=A(e);r(a,"download"),t([])},M=e=>{if(e.length){if(R(e).pluck("client_id").unique().toArray().length>1)return h.error("multiple_client_error");i(e)}},P=e=>e.every(({client_id:t,amount:a,status_id:v})=>t&&a>0&&v!==y.Applied),{setChangeTemplateVisible:w,setChangeTemplateResources:D}=N();return[({selectedIds:e,setSelected:t})=>o(L,{selectedIds:e,setSelected:t}),({selectedIds:e,setSelected:t})=>o(c,{onClick:()=>{l(e),t([])},icon:o(m,{element:q}),children:n("print_pdf")}),({selectedIds:e,setSelected:t})=>o(c,{onClick:()=>{p(e),t([])},icon:o(m,{element:k}),children:n("download_pdf")}),({selectedIds:e,selectedResources:t,setSelected:a})=>u(t)&&o(c,{onClick:()=>{s(e,"mark_sent"),a([])},icon:o(m,{element:F}),children:n("mark_sent")}),({selectedResources:e,setSelected:t})=>P(e)&&d("create_payment")&&o(c,{onClick:()=>{M(e),t([])},icon:o(m,{element:Q}),children:n("apply_credit")}),({selectedResources:e,setSelected:t})=>o(c,{onClick:()=>g(e)?b(e,t):h.error("no_documents_to_download"),icon:o(m,{element:k}),children:n("documents")}),({selectedResources:e})=>o(c,{onClick:()=>{w(!0),D(e)},icon:o(m,{element:V}),children:n("run_template")})]};export{fe as u};
