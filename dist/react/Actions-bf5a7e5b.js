import{a0 as E,n as $,a1 as Y,a as n,F as D,U as Q,O as S,a2 as I,j as b,d as C,a3 as R,p as U,A as O,a4 as H,a5 as X,a6 as z,a7 as G,a8 as w,a9 as J,aa as L,ab as W,ac as Z,ad as ee,ae as te,X as ie,H as T,af as oe,ag as ne,K as ae,ah as ce}from"./index-ecbcc3c7.js";import{I as v}from"./invoice-status-756326ba.js";import{N as se,K as j,k as le,w as re,O as B,P as de,Q as _e,I as K,R as ue,a6 as me,a7 as ve,B as pe,U as he,a8 as ye,a9 as fe,V as Ce,s as ke,u as be,t as ge}from"./react-icons-071f44cd.js";import{bn as A}from"./dayjs-75976aa4.js";import{a as g}from"./react-router-82cc6afb.js";import{c as k}from"./jotai-c7720f6e.js";import{r as q}from"./react-e483b31d.js";import"./classnames-eea0979a.js";import"./react-debounce-input-20b6d49d.js";import"./react-redux-7b717b6c.js";import{u as x}from"./react-i18next-91d47f13.js";import{R as xe,k as we,i as Ae}from"./react-feather-90dbe0b6.js";/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function Se(){const o=g(),e=k(E);return c=>{e({...c,number:"",documents:[],invoice_id:c.id}),o("/credits/create?action=reverse")}}/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function Qe(){const[o]=x();return{invoice:[{value:"email_invoice",label:o("email_invoice")},{value:"view_pdf",label:o("view_pdf")},{value:"print_pdf",label:o("print_pdf")},{value:"schedule",label:o("schedule")},{value:"delivery_note",label:`${o("delivery_note")} ${o("pdf")}`},{value:"download",label:o("download")},{value:"download_e_invoice",label:o("download_e_invoice")},{value:"mark_sent",label:o("mark_sent")},{value:"mark_paid",label:o("mark_paid")},{value:"auto_bill",label:o("auto_bill")},{value:"enter_payment",label:o("enter_payment")},{value:"client_portal",label:o("client_portal")},{value:"cancel_invoice",label:o("cancel_invoice")},{value:"reverse",label:o("reverse")},{value:"clone_to_invoice",label:o("clone_to_invoice")},{value:"clone_to_other",label:o("clone_to_other")},{value:"archive",label:o("archive")},{value:"restore",label:o("restore")},{value:"delete",label:o("delete")}]}}function Me(){const[o]=x();return{invoice:[{value:"mark_sent",label:o("mark_sent")},{value:"email_invoice",label:o("email_invoice")}]}}/**
 * Invoice Ninja (https://invoiceninja.com).
 *
 * @link https://github.com/invoiceninja/invoiceninja source repository
 *
 * @copyright Copyright (c) 2022. Invoice Ninja LLC (https://invoiceninja.com)
 *
 * @license https://www.elastic.co/licensing/elastic-license
 */function Pe(o){const e=$(),{commonActionsSection:c,entity:a}=o,{isEditPage:d}=Y({entity:a}),s=Me();return r=>{var _,m,u,y;if(!d)return!0;const i=(_=e==null?void 0:e.company_user)==null?void 0:_.react_settings.common_actions;return!i||!c&&(i!=null&&i[a])&&!((m=i[a])!=null&&m.includes(r))||!(i!=null&&i[a])&&s[a].some(({value:h})=>h===r)&&c?!0:i&&c?(u=i[a])==null?void 0:u.includes(r):!(i!=null&&i[a])&&!c?!((y=s[a])!=null&&y.some(({value:h})=>h===r)):!1}}function l(o){const e=g(),{isCommonActionSection:c,onClick:a,to:d,icon:s,tooltipText:r,entity:i,actionKey:_,excludePreferences:m,setVisible:u}=o;return!Pe({commonActionsSection:c,entity:i})(_)&&!m?n(D,{}):c?n(Q,{width:"auto",placement:"bottom",message:r,withoutArrow:!0,children:n("div",{onClick:()=>d?e(d):a==null?void 0:a(),children:n(S,{element:s,size:23.5})})}):n(I,{to:d,icon:n(S,{element:o.icon}),onClick:a,setVisible:u,children:o.children})}function Te(o){const[e]=x(),c=g(),[a,d]=q.useState(!1),{invoice:s,isDropdown:r=!1}=o,i=_=>_==null?void 0:_.contacts.some(({email:m})=>m);return b(D,{children:[n("div",{onClick:()=>!i(s.client)&&d(!0),children:n(l,{entity:"invoice",actionKey:"email_invoice",isCommonActionSection:!r,tooltipText:e("email_invoice"),...i(s.client)&&{to:C("/invoices/:id/email",{id:s.id})},icon:se,children:e("email_invoice")})}),n(R,{title:e("contact_email"),visible:a,onClose:()=>d(!1),children:b("div",{className:"flex flex-col items-center space-y-4",children:[b("span",{className:"text-base font-medium",children:[e("client_email_not_set"),"."]}),n(U,{className:"self-end",onClick:()=>{c(C("/clients/:id/edit",{id:s.client_id})),d(!1)},children:e("edit_client")})]})})]})}function Ie(o){const[e]=x(),c=g(),{invoice:a,dropdown:d}=o,s=O(),r=k(H),i=k(E),_=k(X),m=k(z),u=G(),[y,h]=q.useState(!1),M=()=>{r({...a,id:"",number:"",documents:[],date:A().format("YYYY-MM-DD"),due_date:"",total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0,design_id:u.settings.quote_design_id}),c("/quotes/create?action=clone")},p=()=>{i({...a,id:"",number:"",documents:[],date:A().format("YYYY-MM-DD"),due_date:"",total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0,design_id:u.settings.credit_design_id}),c("/credits/create?action=clone")},f=()=>{m({...a,id:"",number:"",documents:[],frequency_id:"5",total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0,design_id:u.settings.invoice_design_id}),c("/recurring_invoices/create?action=clone")},P=()=>{_({...a,id:"",number:"",documents:[],date:A().format("YYYY-MM-DD"),total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"1",vendor_id:"",paid_to_date:0,design_id:u.settings.purchase_order_design_id}),c("/purchase_orders/create?action=clone")};return b(D,{children:[(s("create_purchase_order")||s("create_quote")||s("create_recurring_invoice")||s("create_credit"))&&n(l,{entity:"invoice",actionKey:"clone_to_other",isCommonActionSection:!d,tooltipText:e("clone_to_other"),onClick:()=>h(!0),icon:j,children:e("clone_to_other")}),n(R,{title:e("clone_to"),visible:y,onClose:()=>h(!1),closeButtonCypressRef:"cloneOptionsModalXButton",children:n("div",{className:"flex justify-center",children:b("div",{className:"flex flex-1 flex-col items-center space-y-3",children:[s("create_recurring_invoice")&&n(w,{label:e("recurring_invoice"),icon:xe,onClick:f}),s("create_quote")&&n(w,{label:e("quote"),icon:we,onClick:M}),s("create_credit")&&n(w,{label:e("credit"),icon:Ae,onClick:p}),s("create_purchase_order")&&n(w,{label:e("purchase_order"),icon:le,onClick:P})]})})})]})}const De=o=>{var e;return o.balance>0&&(o.status_id===v.Sent||o.status_id===v.Partial)&&!!((e=o.client)!=null&&e.gateway_tokens.length)};function Ue(o){const{t:e}=x(),c=O(),{isAdmin:a,isOwner:d}=J(),{showEditAction:s,showCommonBulkAction:r,dropdown:i=!0}=o||{},_=g(),m=L({resource:"invoice"}),u=W({resource:"invoice"}),y=Z({entity:"invoice"}),h=ee({entity:"invoice"}),M=Se(),p=te(),{isEditPage:f}=Y({entity:"invoice"}),P=k(ce),N=t=>{P({...t,id:"",number:"",documents:[],due_date:"",date:A().format("YYYY-MM-DD"),total_taxes:0,exchange_rate:1,last_sent_date:"",project_id:"",subscription_id:"",status_id:"",vendor_id:"",paid_to_date:0}),_("/invoices/create?action=clone")},{setChangeTemplateVisible:F,setChangeTemplateResources:V}=ie();return[t=>!!s&&n(I,{to:C("/invoices/:id/edit",{id:t.id}),icon:n(S,{element:re}),children:e("edit")}),()=>!!s&&i&&n(T,{withoutPadding:!0}),t=>n(Te,{...!i&&{key:"email_invoice"},invoice:t,isDropdown:i}),t=>n(l,{...!i&&{key:"view_pdf"},entity:"invoice",actionKey:"view_pdf",isCommonActionSection:!i,tooltipText:e("view_pdf"),to:C("/invoices/:id/pdf",{id:t.id}),icon:B,children:e("view_pdf")}),t=>oe(t)!==ne.Deleted&&n(l,{...!i&&{key:"print_pdf"},entity:"invoice",actionKey:"print_pdf",isCommonActionSection:!i,tooltipText:e("print_pdf"),onClick:()=>y([t.id]),icon:de,children:e("print_pdf")}),t=>t.status_id!==v.Paid&&(a||d)&&n(l,{...!i&&{key:"schedule"},entity:"invoice",actionKey:"schedule",isCommonActionSection:!i,tooltipText:e("schedule"),onClick:()=>h(t.id),icon:_e,children:e("schedule")}),t=>b(l,{...!i&&{key:"delivery_note"},entity:"invoice",actionKey:"delivery_note",isCommonActionSection:!i,tooltipText:`${e("delivery_note")} ${e("pdf")}`,to:C("/invoices/:id/pdf?delivery_note=true",{id:t.id}),icon:B,children:[e("delivery_note")," (",e("pdf"),")"]}),t=>n(l,{...!i&&{key:"download"},entity:"invoice",actionKey:"download",isCommonActionSection:!i,tooltipText:e("download"),onClick:()=>m(t),icon:K,children:e("download")}),t=>n(l,{...!i&&{key:"download_e_invoice"},entity:"invoice",actionKey:"download_e_invoice",isCommonActionSection:!i,tooltipText:e("download_e_invoice"),onClick:()=>u(t),icon:K,children:e("download_e_invoice")}),t=>t.status_id===v.Draft&&!t.is_deleted&&n(l,{...!i&&{key:"mark_sent"},entity:"invoice",actionKey:"mark_sent",isCommonActionSection:!i,tooltipText:e("mark_sent"),onClick:()=>p([t.id],"mark_sent"),icon:ue,children:e("mark_sent")}),t=>parseInt(t.status_id)<parseInt(v.Paid)&&!t.is_deleted&&n(l,{...!i&&{key:"mark_paid"},entity:"invoice",actionKey:"mark_paid",isCommonActionSection:!i,tooltipText:e("mark_paid"),onClick:()=>p([t.id],"mark_paid"),icon:me,children:e("mark_paid")}),t=>De(t)&&n(l,{...!i&&{key:"auto_bill"},entity:"invoice",actionKey:"auto_bill",isCommonActionSection:!i,tooltipText:e("auto_bill"),onClick:()=>p([t.id],"auto_bill"),icon:ve,children:e("auto_bill")}),t=>parseInt(t.status_id)<4&&c("create_payment")&&n(l,{...!i&&{key:"enter_payment"},entity:"invoice",actionKey:"enter_payment",isCommonActionSection:!i,tooltipText:e("enter_payment"),to:C("/payments/create?invoice=:invoiceId&client=:clientId",{invoiceId:t.id,clientId:t.client_id}),icon:pe,children:e("enter_payment")}),t=>n(l,{...!i&&{key:"client_portal"},entity:"invoice",actionKey:"client_portal",isCommonActionSection:!i,tooltipText:e("client_portal"),onClick:()=>t&&ae(t),icon:he,children:e("client_portal")}),t=>(t.status_id===v.Sent||t.status_id===v.Partial)&&n(l,{...!i&&{key:"cancel_invoice"},entity:"invoice",actionKey:"cancel_invoice",isCommonActionSection:!i,tooltipText:e("cancel_invoice"),onClick:()=>p([t.id],"cancel"),icon:ye,children:e("cancel_invoice")}),t=>(t.status_id===v.Paid||t.status_id===v.Partial)&&!t.is_deleted&&!t.archived_at&&c("create_credit")&&n(l,{...!i&&{key:"reverse"},entity:"invoice",actionKey:"reverse",isCommonActionSection:!i,tooltipText:e("reverse"),onClick:()=>M(t),icon:fe,children:e("reverse")}),t=>n(I,{onClick:()=>{F(!0),V([t])},icon:n(S,{element:Ce}),children:e("run_template")}),()=>i&&n(T,{withoutPadding:!0}),t=>c("create_invoice")&&n(l,{...!i&&{key:"clone_to_invoice"},entity:"invoice",actionKey:"clone_to_invoice",isCommonActionSection:!i,tooltipText:e("clone_to_invoice"),onClick:()=>N(t),icon:j,children:e("clone_to_invoice")}),t=>n(Ie,{...!i&&{key:"clone_to_other"},dropdown:i,invoice:t}),()=>(f||!!r)&&i&&n(T,{withoutPadding:!0}),t=>(f||!!r)&&t.archived_at===0&&n(l,{...!i&&{key:"archive"},entity:"invoice",actionKey:"archive",isCommonActionSection:!i,tooltipText:e("archive"),onClick:()=>p([t.id],"archive"),icon:ke,excludePreferences:!0,children:e("archive")}),t=>(f||!!r)&&t.archived_at>0&&t.status_id!==v.Cancelled&&n(l,{...!i&&{key:"restore"},entity:"invoice",actionKey:"restore",isCommonActionSection:!i,tooltipText:e("restore"),onClick:()=>p([t.id],"restore"),icon:be,excludePreferences:!0,children:e("restore")}),t=>(f||!!r)&&!t.is_deleted&&n(l,{...!i&&{key:"delete"},entity:"invoice",actionKey:"delete",isCommonActionSection:!i,tooltipText:e("delete"),onClick:()=>p([t.id],"delete"),icon:ge,excludePreferences:!0,children:e("delete")})]}export{Se as a,Qe as b,De as i,Ue as u};
